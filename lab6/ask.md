# Аппроксимация методом наименьших квадратов: Двухпараметрические модели

Особенно актуальной задачей аппроксимации (см. работу 8) становится тогда, когда имеются априорные данные о приближаемой функции. Существует формальный подход для выбора вида аппроксимирующей функции, зависящей от небольшого числа параметров, а именно двух.

В данной работе вид эмпирической зависимости предложено выбирать, используя характеристические свойства некоторых элементарных функций.

## Введение обозначений

Для анализа введем следующие обозначения:

- $x_a = \frac{x_1 + x_2}{2}$ — среднее арифметическое двух чисел.
- $x_g = \sqrt{x_1 x_2}$ — среднее геометрическое двух чисел.
- $x_h = \frac{2}{\frac{1}{x_1} + \frac{1}{x_2}}$ — среднее гармоническое двух чисел.

## Свойства функций

Легко видеть, что следующие девять функций обладают указанными свойствами:

1. $z_1(x) = ax + b \implies z_1(x_a) = z_a$
2. $z_2(x) = ax^b \implies z_2(x_g) = z_g$
3. $z_3(x) = ae^{bx} \implies z_3(x_a) = z_g$
4. $z_4(x) = a \ln x + b \implies z_4(x_g) = z_a$
5. $z_5(x) = a + \frac{b}{x} \implies z_5(x_h) = z_h$
6. $z_6(x) = \frac{1}{ax+b} \implies z_6(x_a) = z_h$
7. $z_7(x) = \frac{x}{ax+b} \implies z(x_h)=z_h$
8. $z_8(x) = ae^{b/x} \implies z_8(x_h) = z_g$
9. $z_9(x) = \frac{1}{a \ln x + b} \implies z_9(x_g) = z_h$


где $z_a$, $z_g$, $z_h$ — среднее арифметическое, среднее геометрическое и среднее гармоническое значения функции $z(x)$ в точках $x_a$, $x_g$, $x_h$ соответственно.

Таким образом, для выбора функции из рассмотренного семейства необходимо выполнить следующие шаги:

## Шаги выбора функции

1. Нанести на график (на миллиметровке) заданные точки $(x_i, y_i)$, $i = 0, \dots, n$, и провести гладкую монотонную кривую, аппроксимирующую эту зависимость (см. рис. 3).
    
2. Вычислить значения величин $x_a$, $x_g$, $x_h$, а также $y_a$, $y_g$, $y_h$ относительно значений $x_0, x_1, \dots, x_n$ и $y_0, y_1, \dots, y_n$, взятых из таблицы. Кроме того, определить по графику функции $z(x)$ значения $z(x_a)$, $z(x_g)$, $z(x_h)$.
    
3. Вычислить значения следующих величин:
    
    - $\delta_1 = |z_1(x_a) - y_a|$,
    - $\delta_2 = |z_2(x_g) - y_g|$,
    - $\delta_3 = |z_3(x_a) - y_g|$,
    - $\delta_4 = |z_4(x_g) - y_a|$,
    - $\delta_5 = |z_5(x_h) - y_h|$,
    - $\delta_6 = |z_6(x_a) - y_h|$,
    - $\delta_7 = |z_7(x_h) - y_h|$,
    - $\delta_8 = |z_8(x_h) - y_g|$,
    - $\delta_9 = |z_9(x_g) - y_h|$,
    
    и выбрать из них наименьшее значение $\delta$. Соответствующий номер функции $z_i(x)$ определяет выбираемую функцию.
    

## Замечание

Все вычисления вести с точностью до одного знака после запятой. Если несколько значений $\delta_i$ совпадут, то следует вычислить их более точно.

## Определение коэффициентов выбранной функции

Предположим, что наименьшим оказалось значение $\delta_1$, соответствующее функции $z(x) = z_1(x) = ax + b$. Тогда коэффициенты $a$ и $b$ определяются по методу наименьших квадратов (МНК, см. работу 8):

$$  
a \sum x_i^2 + b \sum x_i = \sum x_iy_i,  
$$

$$
a \sum x_i + b (n+1) = \sum y_i.  
$$

Коэффициенты $a$ и $b$ в остальных случаях определяются после предварительных преобразований.

### Пример для функций $z_2(x)$, $z_3(x)$ и $z_8(x)$

Функции $z_2(x)$, $z_3(x)$ и $z_8(x)$ следует предварительно прологарифмировать (например, для $z_2(x) = ax^b$ получаем $\ln z_2(x) = \ln a + b \ln x$). Минимизируется величина:

$$ \sum_{i=0}^{n} (\ln a + b \ln x_i - \ln y_i)^2, $$

и решать соответствующую систему относительно $a$ и $b$. Элементами матрицы этой системы будут следующие:
$$ A = \sum_{i=0}^{n} (\ln x_i)^2, \quad B = \sum_{i=0}^{n} \ln x_i, \quad D = \sum_{i=0}^{n} (\ln x_i \cdot \ln y_i), \quad \overline{D} = \sum_{i=0}^{n} \ln y_i. $$

После решения системы по величине $\ln a$ определяем $a$.

### 2. Функции $z_6(x)$, $z_7(x)$ и $z_9(x)$

В случае $z_6(x)$, $z_7(x)$ и $z_9(x)$ следует предварительно перейти к обратным величинам, например, $\frac{1}{z_7(x)} = \frac{ax + b}{x}$. Минимизируется величина:

$$\sum_{i=0}^{n} \left( a x_i + \frac{b}{x_i} - \frac{1}{y_i} \right)^2,$$

и элементы матрицы соответствующей системы уравнений будут состоять из сумм обратных величин $\frac{1}{x_i}$ и $\frac{1}{y_i}$.

### 3. Функции $z_4(x)$ и $z_5(x)$

Функции $z_4(x)$ и $z_5(x)$ остаются без изменений, однако элементы матрицы в этих случаях будут состоять из сумм значений $\ln x_i$ и $\frac{1}{x_i}$ соответственно.

## Задание

1. Построить графики таблично заданной функции и аппроксимирующей функции.
    
2. Найти значения $x_a$, $x_g$, $x_h$, $y_a$, $y_g$, $y_h$, $z(x_a)$, $z(x_g)$, $z(x_h)$, $\delta_1, \dots, \delta_9$, и выбрать $\min \delta_i$.
    
3. Составить систему уравнений для определения $a$ и $b$ и решить её.
    
4. Найти среднеквадратичное отклонение.