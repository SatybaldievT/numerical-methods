## 10. Тригонометрическая интерполяция функций с помощью быстрого преобразования Фурье

Пусть периодическая функция $ f(x)$ с периодом $ I$ может быть разложена в ряд Фурье:

$
f(x) = \sum_{q=-\infty}^{\infty} A_q \exp(2\pi i q x)
$

Рассмотрим значения этой функции на сетке из точек $ x_j = \frac{j}{N} $, где $ j, N $ — целые числа, и обозначим $ f(x_j) = f_j$. Тогда из-за периодичности функции $ f(x)$ ряд Фурье можно записать в виде:

$
f_j = \sum_{g=-\infty}^{\infty} a_g \exp(2\pi i g x_j)
$

Верно и обратное равенство:

$
A_g = \frac{1}{N} \sum_{j=0}^{N-1} f_j \exp(-2\pi i g x_j)
$

Аппроксимация функции $ f(x)$ с помощью приближенного равенства:

$
f(x) \approx \sum_{g=0}^{N-1} A_g \exp(2\pi i g x)
$

Такое название — тригонометрическая интерполяция; коэффициенты $ A_g$ называются дискретными коэффициентами Фурье.

Быстрое преобразование Фурье (БПФ) применяют, если число узлов сетки $ N = 2^r$. Представим числа $ g$ и $ j$, входящие в предыдущие формулы и лежащие в пределах $ 0 \leq g, j < N$, в виде двоичного разложения:

$
g = \sum_{k=1}^{r} g_k 2^{k-1}, \quad j = \sum_{k=1}^{r} j_k 2^{k-1}
$

где $ g_k, j_k = 0, 1$. Его суть состоит в подсчете коэффициентов $ A_g$ с помощью рекуррентных соотношений:

$
A_g = A^{(r)}(g_1, \ldots, g_r)
$

$
A^{(m)}(g_1, \ldots, g_m, j_{m+1}, \ldots, j_r) = \frac{1}{2} \sum_{j_m=0}^{1} \exp(-2\pi i j_m 2^{r-m} g) A^{(m-1)}(g_1, \ldots, g_{m-1}, j_m, \ldots, j_r)
$

$
A^{(0)}(j_1, \ldots, j_r) = f_{j_1 2^{r-1} + \ldots + j_r 2^0}
$

## Задание

1. Вычислить значения функции $ f(x)$ в узлах сетки $ x_j = \frac{j}{N}$, $ N = 128$.  
2. Построить тригонометрическую интерполяцию функции, пользуясь БПФ для подсчета дискретных коэффициентов Фурье.  
3. Сравнить значения тригонометрической интерполяции в средних точках всех отрезков разбиения $ y_j = 0.5 + \frac{j}{N}$, $ j = 0, \ldots, N-1$.